services: 
  fastdfs-tracker: 
    image: registry.cn-hangzhou.aliyuncs.com/zhengqing/fastdfs:latest 
    container_name: fastdfs-tracker 
    restart: always 
    environment: 
      - TRACKER_PORT=22122  # Tracker 默认端口 
      - GROUP_COUNT=1       # 存储组数量，默认1 
    ports:
      - "22122:22122" 
    #volumes: 
    #  - ./tracker_data:/var/fdfs  # 宿主机目录挂载（持久化 Tracker 数据） 
    #network_mode: host
    networks:
      - my-network
    command: tracker  # 指定启动 Tracker 服务 

      
  fastdfs-storage: 
    image: registry.cn-hangzhou.aliyuncs.com/zhengqing/fastdfs:latest 
    container_name: fastdfs-storage 
    restart: always 
    depends_on: 
      - fastdfs-tracker  # 依赖 Tracker 服务，确保先启动 
    environment: 
      - TRACKER_SERVER=fastdfs-tracker:22122  # Tracker 容器名称:端口（需与 Tracker 服务名一致） 
      - STORAGE_PORT=23000                     # Storage 默认端口 
      - GROUP_NAME=group1                      # 存储组名称，默认group1 
      #- PORT=8888                              # HTTP 访问端口 
    ports:
      - "23000:23000"
      - "8088:8080"
      - "8888:8888"                            # 映射 HTTP 端口，用于通过浏览器访问文件 
    volumes: 
      - /share/Public/docker/8888-fastdfs-storage/nginx.conf:/usr/local/nginx/conf/nginx.conf # Nginx配置文件
    #  - ./storage_data:/var/fdfs              # 宿主机目录挂载（持久化 Storage 数据） 
    #  - ./storage_conf:/etc/fdfs              # 可选：挂载配置文件（如需自定义） 
    #network_mode: host
    networks:
      - my-network
    command: storage                           # 指定启动 Storage 服务 


networks:
  my-network:
    external: true
